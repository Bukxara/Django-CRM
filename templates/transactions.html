{% extends 'base.html' %}

{% load humanize %}

{% block content %}

{% if user.is_authenticated %}


<div class="col-12 p-4">
  <table class="table table-dark table-hover table-bordered table align-middle table table">
    <h1>Transaction history</h1>
    <thead class="table-dark">
      <tr class="align-middle text-center">
        <th scope="col">Order #</th>
        <th scope="col">Customer</th>
        <th scope="col">Payment method</th>
        <th scope="col">Status</th>
        <th scope="col">Date</th>
        <th scope="col">Total sum</th>
        <th scope="col">Refunded</th>

      </tr>
    </thead>
    <tbody>
      {% for order in paid_orders %}

      <tr>
        <td class="text-center">{{ order.id }}</td>
        <td class="text-center">{{ order.customer.first_name }} | {{ order.customer.phone_number }}</td>
        <td class="text-center">{{ order.payment_method }}</td>
        {% if order.status != "Cancelled" %}<td style="color:greenyellow" class="text-center">{{ order.status }}</td>
        {% else %}<td style="color:red" class="text-center">{{ order.status }}</td>{% endif %}
        <td class="text-center">{{ order.created_at }}</td>
        <td class="text-center">{{ order.sum|intcomma }} UZS</td>
        <td class="text-center">{% if order.is_refunded %} ✅ {% else %} ❌ {% endif %}</td>
      </tr>

      {% endfor %}
    </tbody>
    <caption style="background-color: rgb(40, 40, 40)" class="h3 text-end p-2">Total Revenue:
      {{ total_revenue|default_if_none:0|intcomma }} UZS
    </caption>
  </table>
</div>
<style>
  td {
    font-size: 20px;
  }
</style>
{% else %}
<h1 class="text-center" style="color:red">You are not admin!</h1>
{% endif %}

{% endblock %}